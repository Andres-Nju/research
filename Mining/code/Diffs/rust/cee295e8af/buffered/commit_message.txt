fix off-by-one error