build: fix doctests, run cargo publish --dry-run (#8689)

Co-authored-by: Bartek Iwa≈Ñczuk <biwanczuk@gmail.com>