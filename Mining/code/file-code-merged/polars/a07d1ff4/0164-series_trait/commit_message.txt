fix(rust, python): ensure set_sorted never panics (#7013)

