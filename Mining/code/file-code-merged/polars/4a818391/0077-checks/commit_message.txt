feat(rust, python): support ternary expressions in streaming (#9343)

