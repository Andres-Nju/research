perf(rust, python): remove O^2 behavior in melt (#7003)

