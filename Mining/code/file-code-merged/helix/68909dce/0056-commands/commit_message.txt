Fix append cursor location when selection anchor is at end of document (#4147)

