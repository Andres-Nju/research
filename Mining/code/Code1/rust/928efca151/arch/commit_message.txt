Fix undefined behaviorFix undefined behavior