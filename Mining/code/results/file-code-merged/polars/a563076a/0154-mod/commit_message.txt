fix(rust, python): check null data before take (#8812)

